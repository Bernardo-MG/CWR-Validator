<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validation results</title>
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/style.css') }}">
    <script
	  src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/cwr.js') }}"></script>
  </head>
  <body>
    <div id="wrapper" class="container">
        <div id="header">
			<div class="page-header">
	            <h1>Validator <small>CWR document validator</small></h1>
            </div>
		</div>
		<div id="header_menu">
            <div class="navbar navbar-inverse" role="navigation">
	            <div class="navbar-header">
		            <button type="button" class="navbar-toggle" data-toggle="collapse"
			            data-target="#bs-example-navbar-collapse-1">
			            <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span>
			            <span class="icon-bar"></span> <span class="icon-bar"></span>
		            </button>
		            <a class="navbar-brand" href="/">Home</a>
	               </div>
	            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		            <ul class="nav navbar-nav">
			            <li><a href="/upload">Upload file</a></li>
				        <!-- <li><a href="#">View results</a></li> -->
		            </ul>
	            </div>
            </div>
		</div>
        <div id="content">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li class="active"><a href="#summary" data-toggle="tab">Summary</a></li>
              <li><a href="#success" data-toggle="tab">Successful records</a></li>
              <li><a href="#failure" data-toggle="tab">Missed records</a></li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane active" id="summary">
                  <dl>
                    <dt>Document name</dt>
                    <dd> {{ document._name }} </dd>
                    <dt>Records found</dt>
                    <dd> {{ document._records_number}} </dd>
                    <dt>Transactions found</dt>
                    <dd>{{ document.transactions|length }}</dd>
                    <dt>Successful records</dt>
                    <dd> {{ 2 + document._group_types|length + document.transactions|length + document._records|length }} </dd>
                    <dt>Missed records</dt>
                    <dd> {{ document.errors|length }} </dd>
                    <dt>Document header</dt>
                    <dd> {{ document._transmission_header._record }} </dd>
                    <dt>Document trailer</dt>
                    <dd> {{ document._transmission_trailer._record }} </dd>
                  </dl>
                  <p><a class="btn btn-primary disabled" role="button" href="#">Download generated response</a></p>
                </div>
                <div class="tab-pane" id="success">
                  <div class="well well-lg">
                  <div class="btn-group">
                    <label class="btn btn-default active">
                      <input id="agr" type="checkbox" checked onclick="togglePanels(this)"> Agreements
                    </label>
                    <label class="btn btn-default active">
                      <input id="nwr" type="checkbox" checked onclick="togglePanels(this)"> New works registration
                    </label>
                    <label class="btn btn-default active">
                      <input id="rev" type="checkbox" checked onclick="togglePanels(this)"> Revised works registration
                    </label>
                  </div>
                  </div>
                  {% for transaction in document.transactions.values() %}
                    <div class="panel panel-success {{ transaction.attr_dict['Record prefix'].record_type.lower() }}">
                      <div class="panel-heading">
                        {{ transaction._record }}
                      </div>
                      <div class="panel-body">
                        <dl class="dl-horizontal transaction-summary">
                          {% if transaction.attr_dict['Record prefix'].record_type.lower() == 'agr' %}
                          <dt>Territory records</dt>
                          <dd> {{ transaction._records['TER']|length }}</dd>
                          <dt>Interested party records</dt>
                          <dd> {{ transaction._records['IPA']|length }}</dd>
                          {% else %}
                          <p><strong>Not aviable yet</strong></p>
                          {% endif %}
                        </dl>
                      </div>
                      <ul class="list-group">
                          {% for record_list in transaction._records.values() %}
                            {% for record in record_list %}
                            <li class="list-group-item"> {{ record.record }}</li>
                            {% endfor %}
                          {% endfor %}
                      </ul>
                    </div>
                    {% endfor %}
                </div>
                <div class="tab-pane" id="failure">
                  <ul class="list-group">
                  {% for error in document.errors.values() %}
                    <li class="list-group-item bg-danger">{{ error }}</li>
                  {% endfor %}
                  </ul>
                </div>
            </div>
        </div>
      </div>
  </body>
</html>